<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>香港家族旅行 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* 日式極簡配色系統 */
        :root {
            --bg-color: #FDFBF7; /* 和紙白 */
            --card-bg: #FFFFFF;
            --text-main: #2F3542; /* 墨色 */
            --text-sub: #747d8c;
            --accent: #A4B0BE; /* 淺灰 */
            --primary: #535C68; /* 深灰 */
            --highlight-food: #E056FD; /* 美食標籤 */
            --highlight-spot: #4834D4; /* 景點標籤 */
            --highlight-tip: #F0932B; /* 提醒標籤 */
        }
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            -webkit-tap-highlight-color: transparent;
        }
        .card {
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.02), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
            border: 1px solid #f0f0f0;
        }
        .nav-item.active {
            color: #2F3542;
            font-weight: 700;
        }
        .nav-item.active::after {
            content: '';
            display: block;
            width: 6px;
            height: 6px;
            background: #FF6B6B;
            border-radius: 50%;
            margin: 4px auto 0;
        }
        /* 隱藏捲軸 */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden">

    <header class="px-6 pt-12 pb-4 bg-white/80 backdrop-blur-md sticky top-0 z-10 border-b border-gray-100">
        <div class="flex justify-between items-center">
            <div>
                <h1 class="text-xl font-bold tracking-widest text-gray-800">HONG KONG</h1>
                <p class="text-xs text-gray-500 mt-1">2026.01.24 - 01.27 (四天三夜)</p>
            </div>
            <div class="text-right">
                <div id="weather-display" class="bg-blue-50 px-3 py-1 rounded-full flex items-center gap-2">
                    <i class="fas fa-cloud-sun text-blue-400"></i>
                    <span class="text-sm font-medium text-blue-800">19°C</span>
                </div>
            </div>
        </div>
    </header>

    <main id="main-content" class="flex-1 overflow-y-auto no-scrollbar p-4 pb-24">
        </main>

    <nav class="fixed bottom-0 w-full bg-white border-t border-gray-100 pb-safe pt-2 px-6 flex justify-between items-center z-50 h-20 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.02)]">
        <button onclick="renderItinerary()" class="nav-item active flex flex-col items-center text-gray-400 w-16 transition-all">
            <i class="fas fa-map-location-dot text-xl mb-1"></i>
            <span class="text-[10px]">行程</span>
        </button>
        <button onclick="renderInfo()" class="nav-item flex flex-col items-center text-gray-400 w-16 transition-all">
            <i class="fas fa-ticket text-xl mb-1"></i>
            <span class="text-[10px]">資訊</span>
        </button>
        <button onclick="renderWallet()" class="nav-item flex flex-col items-center text-gray-400 w-16 transition-all">
            <i class="fas fa-wallet text-xl mb-1"></i>
            <span class="text-[10px]">記帳</span>
        </button>
    </nav>

    <script>
        // --- 1. 資料庫 (從你的文件中提取) ---
        const tripData = {
            days: [
                {
                    date: "Day 1 (1/24 六)",
                    title: "抵達與懷舊維港",
                    activities: [
                        { type: "transport", time: "12:50", title: "抵達香港機場", desc: "出關前往巴士總站，搭乘城巴 A21 (往紅磡)。", highlight: "成人$34.6 / 老小$17.3", location: "香港國際機場" },
                        { type: "hotel", time: "14:30", title: "儷凱酒店 Check-in", desc: "A21巴士於「旺角維景酒店」下車，步行2分鐘。", highlight: "訂房代號: agoda", location: "香港儷凱酒店" },
                        { type: "food", time: "15:30", title: "鴻運冰廳餅店", desc: "第一站美食，就在飯店附近。", highlight: "必吃：酥皮蛋塔(趁熱)、菠蘿油", tags: ["必吃"], location: "鴻運冰廳餅店" },
                        { type: "spot", time: "16:30", title: "香港科學館", desc: "小孩放電時間，能量穿梭機。", highlight: "計程車約 HK$50-60", tags: ["親子"], location: "香港科學館" },
                        { type: "spot", time: "18:30", title: "1881 Heritage", desc: "歐式古蹟建築，長輩拍照聖地。", tags: ["拍照"], location: "1881 Heritage" },
                        { type: "food", time: "19:30", title: "尖沙咀晚餐", desc: "海港城或廣東道周邊。", location: "海港城" }
                    ]
                },
                {
                    date: "Day 2 (1/25 日)",
                    title: "祈福與在地美食",
                    activities: [
                        { type: "spot", time: "10:00", title: "黃大仙祠", desc: "太子站搭地鐵(觀塘線)至黃大仙站 B2出口。", highlight: "必做：參拜求籤", tags: ["長輩最愛"], location: "黃大仙祠" },
                        { type: "spot", time: "14:00", title: "又一城 Festival Walk", desc: "九龍塘站C出口。有溜冰場、玩具反斗城。", highlight: "冷氣強、座位多", tags: ["舒適"], location: "又一城" },
                        { type: "food", time: "18:00", title: "聯記麵家", desc: "搭計程車前往石硤尾 (約$30)。", highlight: "必點：八寶飯、炸魚皮、鮮蝦雲吞", tags: ["必吃"], location: "石硤尾聯記麵家" }
                    ]
                },
                {
                    date: "Day 3 (1/26 一)",
                    title: "叮叮車與太平山",
                    activities: [
                        { type: "transport", time: "10:40", title: "體驗叮叮車", desc: "灣仔站A3出口，搭往堅尼地城方向。", highlight: "長輩坐下層较安全", tags: ["體驗"], location: "灣仔莊士敦道" },
                        { type: "spot", time: "11:10", title: "中環街市 & 半山手扶梯", desc: "機利文街下車，步行至手扶梯。", location: "中環街市" },
                        { type: "spot", time: "14:00", title: "大館 Tai Kwun", desc: "荷李活道出口。必拍大芒果樹、紅磚牆。", tags: ["拍照"], location: "大館" },
                        { type: "spot", time: "16:00", title: "太平山頂纜車", desc: "務必從大館搭計程車去纜車站 ($30-40)。", highlight: "凌霄閣看夜景", location: "花園道山頂纜車總站" }
                    ]
                },
                {
                    date: "Day 4 (1/27 二)",
                    title: "早茶與返程",
                    activities: [
                        { type: "food", time: "09:30", title: "新贊記點心皇", desc: "旺角花園街。", highlight: "必點：及第粥 (長輩愛)", tags: ["早茶"], location: "新贊記點心皇" },
                        { type: "spot", time: "11:30", title: "金魚街 & 花墟", desc: "飯店步行即達，長輩逛花墟，小孩看金魚。", location: "旺角花墟" },
                        { type: "spot", time: "13:00", title: "MOKO 新世紀廣場", desc: "最後衝刺、買伴手禮、吹冷氣。", location: "MOKO 新世紀廣場" },
                        { type: "transport", time: "16:15", title: "前往機場", desc: "回飯店拿行李，走到旺角維景酒店搭 A21。", highlight: "預計 17:30 抵達機場", location: "旺角維景酒店" },
                        { type: "flight", time: "19:45", title: "星宇航空 JX236", desc: "快樂返家。", highlight: "21:40 抵達台北", location: "香港國際機場" }
                    ]
                }
            ],
            info: {
                flights: [
                    { dir: "去程", code: "大灣航空 HB703", time: "01/24 10:45 - 12:50", ref: "Trip: PTCD0W / Agoda: MJBVRE" },
                    { dir: "回程", code: "星宇航空 JX236", time: "01/27 19:45 - 21:40", ref: "Trip: D43AUA, D43TZX" }
                ],
                hotel: {
                    name: "香港儷凱酒店 (Le Prabelle Hotel)",
                    address: "香港旺角砵蘭街372號",
                    note: "雙人床 x1, 雙人單床 x1 (共兩間)"
                },
                emergency: [
                    { name: "報案/火警/急救", tel: "999" },
                    { name: "旅外國人急難救助", tel: "(852) 6143-9012" }
                ]
            }
        };

        // --- 2. 渲染函式 ---
        
        // 渲染行程 (Tab 1)
        function renderItinerary() {
            updateNav('Itinerary');
            const container = document.getElementById('main-content');
            let html = `<div class="space-y-8">`;

            tripData.days.forEach((day, index) => {
                html += `
                    <div class="space-y-3">
                        <div class="flex items-baseline gap-2 ml-1">
                            <h2 class="text-lg font-bold text-gray-800">${day.date}</h2>
                            <span class="text-sm text-gray-500">${day.title}</span>
                        </div>
                `;
                
                day.activities.forEach(act => {
                    // 根據類型設定圖示顏色
                    let iconClass = "fa-map-marker-alt";
                    let colorClass = "text-gray-400";
                    let bgClass = "bg-white";
                    
                    if(act.type === 'food') { iconClass = "fa-utensils"; colorClass = "text-pink-500"; }
                    if(act.type === 'transport') { iconClass = "fa-bus"; colorClass = "text-blue-500"; }
                    if(act.type === 'flight') { iconClass = "fa-plane"; colorClass = "text-purple-500"; }
                    if(act.type === 'hotel') { iconClass = "fa-bed"; colorClass = "text-indigo-500"; }
                    
                    // 標籤 HTML
                    let tagsHtml = '';
                    if(act.tags) {
                        act.tags.forEach(tag => {
                            let tagColor = 'bg-gray-100 text-gray-600';
                            if(tag === '必吃') tagColor = 'bg-red-100 text-red-600';
                            if(tag === '長輩最愛') tagColor = 'bg-orange-100 text-orange-600';
                            tagsHtml += `<span class="text-[10px] px-2 py-0.5 rounded-full ${tagColor} mr-1">${tag}</span>`;
                        });
                    }

                    // Google Maps 連結
                    const mapUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(act.location)}`;

                    html += `
                        <div class="card p-4 flex gap-4 relative overflow-hidden">
                            <div class="flex flex-col items-center min-w-[3rem]">
                                <span class="text-xs font-bold text-gray-400">${act.time}</span>
                                <div class="h-full w-0.5 bg-gray-100 mt-2"></div>
                            </div>
                            <div class="flex-1 pb-2">
                                <div class="flex justify-between items-start">
                                    <h3 class="font-bold text-gray-800 text-lg leading-tight">${act.title}</h3>
                                    <i class="fas ${iconClass} ${colorClass} opacity-80"></i>
                                </div>
                                <div class="mt-1 mb-2">${tagsHtml}</div>
                                <p class="text-sm text-gray-600 leading-relaxed">${act.desc}</p>
                                ${act.highlight ? `<p class="text-xs text-orange-600 mt-2 font-medium bg-orange-50 inline-block px-2 py-1 rounded"><i class="fas fa-highlighter mr-1"></i>${act.highlight}</p>` : ''}
                                
                                <a href="${mapUrl}" target="_blank" class="mt-3 flex items-center gap-2 text-xs font-bold text-blue-600 hover:bg-blue-50 w-fit px-3 py-1.5 rounded-lg border border-blue-100 transition-colors">
                                    <i class="fas fa-location-arrow"></i> 導航去這裡
                                </a>
                            </div>
                        </div>
                    `;
                });
                html += `</div>`; // end day
            });
            html += `</div>`;
            container.innerHTML = html;
        }

        // 渲染資訊 (Tab 2)
        function renderInfo() {
            updateNav('Info');
            const container = document.getElementById('main-content');
            const info = tripData.info;
            
            let html = `<div class="space-y-6">`;
            
            // 航班卡片
            html += `<div class="card p-5">
                <h3 class="text-sm font-bold text-gray-400 uppercase tracking-wider mb-4">Flights 航班資訊</h3>
                ${info.flights.map(f => `
                    <div class="mb-4 last:mb-0 border-l-4 border-blue-400 pl-3">
                        <div class="flex justify-between">
                            <span class="text-xs font-bold bg-blue-100 text-blue-800 px-2 py-0.5 rounded">${f.dir}</span>
                            <span class="font-mono font-bold text-gray-800">${f.code}</span>
                        </div>
                        <div class="text-sm mt-1 text-gray-600">${f.time}</div>
                        <div class="text-xs text-gray-400 mt-1 select-all">代號: ${f.ref}</div>
                    </div>
                `).join('')}
            </div>`;

            // 住宿卡片
            html += `<div class="card p-5">
                <h3 class="text-sm font-bold text-gray-400 uppercase tracking-wider mb-4">Hotel 住宿</h3>
                <div class="flex gap-3">
                    <div class="bg-indigo-50 w-10 h-10 rounded-full flex items-center justify-center text-indigo-500"><i class="fas fa-hotel"></i></div>
                    <div>
                        <h4 class="font-bold text-gray-800">${info.hotel.name}</h4>
                        <p class="text-sm text-gray-500 mt-1">${info.hotel.address}</p>
                        <p class="text-xs bg-gray-100 text-gray-600 inline-block px-2 py-1 rounded mt-2">${info.hotel.note}</p>
                        <a href="https://www.google.com/maps/search/?api=1&query=${info.hotel.name}" target="_blank" class="block mt-3 text-sm text-blue-600 font-medium">查看地圖</a>
                    </div>
                </div>
            </div>`;

            // 緊急聯絡
            html += `<div class="card p-5 bg-red-50 border-red-100">
                <h3 class="text-sm font-bold text-red-400 uppercase tracking-wider mb-3">Emergency 緊急聯絡</h3>
                <div class="grid grid-cols-2 gap-4">
                    ${info.emergency.map(e => `
                        <a href="tel:${e.tel}" class="bg-white p-3 rounded-lg text-center shadow-sm">
                            <div class="text-xs text-gray-500 mb-1">${e.name}</div>
                            <div class="text-lg font-bold text-red-600">${e.tel}</div>
                        </a>
                    `).join('')}
                </div>
            </div>`;

            html += `</div>`;
            container.innerHTML = html;
        }

        // 渲染記帳 (Tab 3) - 使用 LocalStorage
        function renderWallet() {
            updateNav('Wallet');
            const container = document.getElementById('main-content');
            
            // 讀取舊資料
            const expenses = JSON.parse(localStorage.getItem('hk_trip_expenses') || '[]');
            const total = expenses.reduce((sum, item) => sum + Number(item.amount), 0);

            let html = `
                <div class="space-y-4">
                    <div class="card p-6 bg-gray-800 text-white flex justify-between items-center">
                        <div>
                            <p class="text-gray-400 text-xs uppercase">Total Spent</p>
                            <h2 class="text-3xl font-bold mt-1">HK$ <span id="total-amount">${total}</span></h2>
                        </div>
                        <div class="bg-gray-700 w-10 h-10 rounded-full flex items-center justify-center">
                            <i class="fas fa-coins text-yellow-400"></i>
                        </div>
                    </div>

                    <div class="card p-4">
                        <h3 class="text-sm font-bold text-gray-500 mb-3">新增支出</h3>
                        <div class="flex gap-2 mb-2">
                            <input type="text" id="ex-title" placeholder="項目 (如: 蛋塔)" class="flex-1 bg-gray-50 border-0 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-200 outline-none">
                            <input type="number" id="ex-amount" placeholder="$" class="w-20 bg-gray-50 border-0 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-200 outline-none">
                        </div>
                        <button onclick="addExpense()" class="w-full bg-black text-white rounded-lg py-2.5 text-sm font-bold shadow-lg shadow-gray-200 active:scale-95 transition-transform">
                            記一筆
                        </button>
                    </div>

                    <div class="space-y-2">
                        <h3 class="text-xs font-bold text-gray-400 uppercase ml-1">History</h3>
                        <div id="expense-list" class="space-y-2">
                            ${expenses.length === 0 ? '<p class="text-center text-gray-300 text-sm py-4">還沒有記帳紀錄</p>' : ''}
                            ${expenses.map((item, idx) => `
                                <div class="card px-4 py-3 flex justify-between items-center">
                                    <span class="text-sm text-gray-700 font-medium">${item.title}</span>
                                    <div class="flex items-center gap-3">
                                        <span class="font-mono font-bold">HK$${item.amount}</span>
                                        <button onclick="deleteExpense(${idx})" class="text-gray-300 hover:text-red-500"><i class="fas fa-times-circle"></i></button>
                                    </div>
                                </div>
                            `).reverse().join('')}
                        </div>
                    </div>
                </div>
            `;
            container.innerHTML = html;
        }

        // --- 3. 邏輯控制 ---

        function updateNav(activeTab) {
            // 這裡只是簡單的 UI 切換，實際 class 都在 HTML 寫死了，簡化邏輯
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active', 'text-gray-800'));
            const idx = activeTab === 'Itinerary' ? 0 : activeTab === 'Info' ? 1 : 2;
            const btn = document.querySelectorAll('.nav-item')[idx];
            btn.classList.add('active', 'text-gray-800');
            btn.classList.remove('text-gray-400');
        }

        function addExpense() {
            const title = document.getElementById('ex-title').value;
            const amount = document.getElementById('ex-amount').value;
            if(!title || !amount) return;

            const expenses = JSON.parse(localStorage.getItem('hk_trip_expenses') || '[]');
            expenses.push({ title, amount, date: new Date().toISOString() });
            localStorage.setItem('hk_trip_expenses', JSON.stringify(expenses));
            renderWallet(); // 重新渲染
        }

        function deleteExpense(index) {
            if(!confirm('確定刪除這筆紀錄？')) return;
            const expenses = JSON.parse(localStorage.getItem('hk_trip_expenses') || '[]');
            // 注意：因為顯示時是 reverse()，刪除時要小心索引，這裡簡單處理：
            // 建議在 production 改用 unique ID，這裡 demo 用 index 
            // 為了簡化，直接重整陣列
            expenses.splice(index, 1); 
            localStorage.setItem('hk_trip_expenses', JSON.stringify(expenses));
            renderWallet();
        }

        function switchTab(tab) {
            if(tab === 'itinerary') renderItinerary();
            if(tab === 'info') renderInfo();
            if(tab === 'budget') renderWallet();
        }

        // --- 4. 初始化 ---
        document.addEventListener('DOMContentLoaded', () => {
            renderItinerary();
        });

    </script>
</body>
</html>